<div class="col-12 col-sm-12 col-lg-10" style="margin-bottom:30px">
  <div class="main-header">
    <h2>Collections Report</h2>
    <label class="sr-only">Collections Report</label>
  </div>
  <div class="col-12 col-sm-12 col-lg-10">
	<form id="collection_rept_form" method="get" action="/collection_report/" class="form-search" style="background-color:#fff">
	  <div class="well">
	    <label>Report type</label>
	    <select id="query_type" name="query_type" autocomplete="off" onchange="this.form.submit()" style="margin: 0 0 12px 3px;">
	      <option value="summary" <% if @query_type == "summary" %>selected="selected"<% end %>>Collections summary</option>
	  	<option value="detailed" <% if @query_type == "detailed" %>selected="selected"<% end %>>Collections detailed</option>
	    </select>
	  </div>
    </form>
  </div>
  <div class="col-12 col-sm-12 col-lg-10" style="">
    <% if @collections != nil %>
      <div class="row" style="margin-top:6px">
        <div class="col-4 col-sm-4 col-lg-4" style="border-bottom:2px solid #ddd;">
	  		<strong>Name</strong>
	    </div>
        <div class="col-1 col-sm-1 col-lg-1" style="border-bottom:2px solid #ddd;padding-left: 10px;">
	  		<strong>Items</strong>
	    </div>
        <div class="col-3 col-sm-3 col-lg-3" style="border-bottom:2px solid #ddd;">
	  		<strong>Created by</strong>
	    </div>
        <div class="col-2 col-sm-2 col-lg-2" style="border-bottom:2px solid #ddd;">
	  		<strong>Created</strong>
	    </div>
        <div class="col-2 col-sm-2 col-lg-2" style="border-bottom:2px solid #ddd;">
	  		<strong>Updated</strong>
	    </div>
	  </div>
	    <% if @num_found <= @per_page.to_i %>
	      <% start = 0 %>
	      <% finish = -1 %>
	    <% else %> 
	      <% start = @start_at.to_i %>
	      <% finish = (@start_at.to_i + @per_page - 1)%>
	    <% end %>
	    <% @collections[start..finish].each do |c| %>
	      <div class="row" style="margin-top:6px">
	  	    <div class="col-4 col-sm-4 col-lg-4" style="margin-top:5px"><%=c['title']%></div>
	  	    <div class="col-1 col-sm-1 col-lg-1" style="text-align: center"><%=c['item_count']%></div>
	  	    <div class="col-3 col-sm-3 col-lg-3" style="text-align: left"><%=c['creator']%></div>
	  	    <div class="col-2 col-sm-2 col-lg-2" style="text-align: left"><%=c['created'][0..9]%></div>
	  	    <div class="col-2 col-sm-2 col-lg-2" style="text-align: left"><%=c['modified'][0..9]%></div>
	      </div>
		  <%if @query_type == "detailed" && c['item_count'].to_i > 0%>
	        <div class="row" style="margin-top:2px">
		      <% count = 0 %>
	          <% c['items'].each do |i| %>
	  	      <div class="col-5 col-sm-5 col-lg-5" style="text-align: right;padding-right:0;">
		        <% if count == 0 %><strong>Titles</strong><% end %></div>
	            <div class="col-7 col-sm-7 col-lg-7" style="text-align: left;margin-bottom:8px;">
	              <%= i.title[0] %>
	            </div>
	            <% count = count + 1%>
	          <% end %>
	        </div>
		  <% end %>
	    <% end %>
	    <% if @num_found > @per_page.to_i %>
          <% next_start = @start_at.to_i + @per_page.to_i%>
          <% prev_start = @start_at.to_i - @per_page.to_i%>
	      <% start = 0 %>
	      <% finish = -1 %>
	      <div class="row" style="margin-top:16px">
		      <div class="col-5 col-sm-5 col-lg-5">
		        <%if @start_at.to_i <= 0 %>
		          &lt;&lt; Previous
		        <% else %>
		          <a href="/collection_report?query_type=<%=@query_type%>&start=<%= prev_start %>">
			        &lt;&lt; Previous
			      </a>
			    <% end %> | 
		        <%if @num_found.to_i > @start_at.to_i + @per_page.to_i %>
		          <a href="/collection_report?query_type=<%=@query_type%>&start=<%= next_start %>">
			         Next &gt;&gt;
			      </a>
		        <% else %>
		          Next &gt;&gt;
		        <% end %>
		      </div>
          </div>
	    <% end %> 
	
	<% end %>
  </div>

</div>